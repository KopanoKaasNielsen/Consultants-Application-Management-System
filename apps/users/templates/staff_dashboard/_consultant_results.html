<div
  id="consultant-results"
  class="consultant-results"
  hx-indicator="#results-loading"
  role="region"
  aria-live="polite"
  aria-labelledby="consultant-results-heading"
>
  <section class="staff-dashboard-section consultant-results__section card">
    <div class="card-body consultant-results__body">
      <div class="consultant-results__header d-flex flex-column flex-md-row align-items-md-center justify-content-between gap-2 mb-3">
        <h2 id="consultant-results-heading" class="consultant-results__title h4 mb-0">{{ active_status_label }} Consultant Applications</h2>
        <a
          class="btn btn-outline-primary consultant-results__export"
          href="{% url 'staff_dashboard_export' %}{% if base_querystring %}?{{ base_querystring }}{% endif %}"
          data-download-url="{% url 'staff_dashboard_export' %}{% if base_querystring %}?{{ base_querystring }}{% endif %}"
          hx-get="{% url 'staff_dashboard' %}{% if base_querystring %}?{{ base_querystring }}{% endif %}"
          hx-target="#consultant-results"
          hx-swap="outerHTML"
          hx-push-url="true"
          hx-indicator="#results-loading"
          hx-on::after-request="window.location.href = this.dataset.downloadUrl"
        >
          Export CSV
        </a>
      </div>

      {% if page_obj.object_list %}
        <p class="consultant-results__instructions text-muted">Select an action for each application and optionally leave an internal comment.</p>

        <div class="consultant-results__table-wrapper table-responsive">
          {% include "staff_dashboard/_consultant_list.html" %}
        </div>

      {% if is_paginated %}
        <nav class="consultant-results__pagination" aria-label="Consultant pagination">
          <ul class="consultant-results__pagination-list pagination">
            {% if page_obj.has_previous %}
              <li class="page-item">
                <a
                  class="page-link"
                  href="{% url 'staff_dashboard' %}?{% if base_querystring %}{{ base_querystring }}&amp;{% endif %}page={{ page_obj.previous_page_number }}"
                  hx-get="{% url 'staff_dashboard' %}?{% if base_querystring %}{{ base_querystring }}&amp;{% endif %}page={{ page_obj.previous_page_number }}"
                  hx-target="#consultant-results"
                  hx-swap="outerHTML"
                  hx-push-url="true"
                  hx-indicator="#results-loading"
                >
                  Previous
                </a>
              </li>
            {% else %}
              <li class="page-item disabled"><span class="page-link">Previous</span></li>
            {% endif %}

            {% for page_number in paginator.page_range %}
              {% if page_number == page_obj.number %}
                <li class="page-item active" aria-current="page"><span class="page-link">{{ page_number }}</span></li>
              {% else %}
                <li class="page-item">
                  <a
                    class="page-link"
                    href="{% url 'staff_dashboard' %}?{% if base_querystring %}{{ base_querystring }}&amp;{% endif %}page={{ page_number }}"
                    hx-get="{% url 'staff_dashboard' %}?{% if base_querystring %}{{ base_querystring }}&amp;{% endif %}page={{ page_number }}"
                    hx-target="#consultant-results"
                    hx-swap="outerHTML"
                    hx-push-url="true"
                    hx-indicator="#results-loading"
                  >
                    {{ page_number }}
                  </a>
                </li>
              {% endif %}
            {% endfor %}

            {% if page_obj.has_next %}
              <li class="page-item">
                <a
                  class="page-link"
                  href="{% url 'staff_dashboard' %}?{% if base_querystring %}{{ base_querystring }}&amp;{% endif %}page={{ page_obj.next_page_number }}"
                  hx-get="{% url 'staff_dashboard' %}?{% if base_querystring %}{{ base_querystring }}&amp;{% endif %}page={{ page_obj.next_page_number }}"
                  hx-target="#consultant-results"
                  hx-swap="outerHTML"
                  hx-push-url="true"
                  hx-indicator="#results-loading"
                >
                  Next
                </a>
              </li>
            {% else %}
              <li class="page-item disabled"><span class="page-link">Next</span></li>
            {% endif %}
          </ul>
        </nav>
      {% endif %}
    {% else %}
      <p class="mb-0">No {{ active_status_label|lower }} applications match your current filters.</p>
    {% endif %}
    </div>
  </section>
</div>
